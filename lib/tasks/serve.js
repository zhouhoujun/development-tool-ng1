"use strict";var __decorate=this&&this.__decorate||function(e,t,r,o){var n,s=arguments.length,a=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},_=require("lodash"),development_core_1=require("development-core"),browserSync=require("browser-sync"),path=require("path"),StartServer=function(){function e(e){this.info=e}return e.prototype.getInfo=function(){return this.info.name=this.info.name||"web-serve",this.info},e.prototype.setup=function(e,t){var r=e.option.browsersync||{},o=null;r.files&&(o=_.isFunction(r.files)?r.files(e):r.files),o=o||[];var n=e.getPackage(),s="";r.jspm&&r.jspm.packages?s=e.toRootPath(e.toStr(r.jspm.packages)):n.jspm&&n.jspm&&n.jspm.directories&&(s=e.toRootPath(n.jspm.directories.packages)),s&&o.push(s+"/**/*");var a=e.getDist(this.getInfo()),i=null;i=r.baseDir?e.toRootSrc(_.isFunction(r.baseDir)?r.baseDir(e):r.baseDir):a,i=_.isArray(i)?i:[i];var c=path.relative(_.first(i),s);/^\.\./.test(c)&&(i.push(e.getRootPath()),i=_.uniq(i)),o.push(a+"/**/*");var p={server:{baseDir:i},open:!0,port:process.env.PORT||3e3,files:o};r.browsersync&&(p=_.extend(p,_.isFunction(r.browsersync)?r.browsersync(e,p):r.browsersync));var f=e.subTaskName(this.info);return t.task(f,function(e){browserSync(p,function(t,r){t&&e(t)})}),f},e}();StartServer=__decorate([development_core_1.task({order:function(e,t){return t.env.test?{value:2/e,runWay:development_core_1.RunWay.parallel}:1},oper:development_core_1.Operation.default|development_core_1.Operation.serve}),__metadata("design:paramtypes",[Object])],StartServer),exports.StartServer=StartServer;
//# sourceMappingURL=../sourcemaps/tasks/serve.js.map
