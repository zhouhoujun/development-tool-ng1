{"version":3,"sources":["tasks/webDefaultTask.js"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","_typeof","decorate","i","defineProperty","__metadata","k","v","metadata","development_core_1","require","karma_1","path","browserSync","WebDefaultTasks","_classCallCheck","this","_createClass","value","name","Operation","clean","default","dt","del","config","getSrc","test","oper","release","deploy","pipe","gulpsrc","callback","option","karmaConfigFile","join","env","root","isAbsolute","order","Server","start","output","dynamicTask","StartService","gulp","configFile","dist","browsersync","server","getDist","open","port","process","PORT","files","tkn","subTaskName","err","bs","e2e"],"mappings":"AAAA,+kBACIA,WAA0C,SAAUC,EAAYC,EAAQC,EAAKC,GAC7E,GAA2HC,GAAvHC,EAAIC,UAAUC,OAAQC,EAAIH,EAAI,EAAIJ,EAAkB,OAATE,EAAgBA,EAAOM,OAAOC,yBAAyBT,EAAQC,GAAOC,CACrH,IAAuB,YAAnB,mBAAOQ,SAAP,YAAAC,QAAOD,WAAoD,kBAArBA,SAAQE,SAAyBL,EAAIG,QAAQE,SAASb,EAAYC,EAAQC,EAAKC,OACpH,KAAK,GAAIW,GAAId,EAAWO,OAAS,EAAGO,GAAK,EAAGA,KAASV,EAAIJ,EAAWc,MAAIN,GAAKH,EAAI,EAAID,EAAEI,GAAKH,EAAI,EAAID,EAAEH,EAAQC,EAAKM,GAAKJ,EAAEH,EAAQC,KAASM,EAChJ,OAAOH,GAAI,GAAKG,GAAKC,OAAOM,eAAed,EAAQC,EAAKM,GAAIA,GAE5DQ,WAA0C,SAAUC,EAAGC,GANvDnB,GAAc,YAAdA,mBAAAA,SAAAA,YAAAA,QAAAA,WAAoDC,kBAAzBD,SAAeoB,SAAsBlB,MAAQC,SAA9BiB,SAAyCF,EAAAC,IACnFE,mBAAAC,QAAA,oBAEsDC,QAAQtB,QAAAA,SAC9DuB,KAAOlB,QAASG,QAJpBgB,YAAAH,QAAA,gBAMIL,IAAAA,QAAc,OACdS,gBAAAA,WAAA,QAAAA,KAAAC,gBAAAC,KAAAF,GAAA,MAAAG,cAAAH,IAAAvB,IAAA,QAAA2B,MAAA,WAEJ,QAEAC,KAAA,QACgBT,MAAQ,EACXA,KAAQD,mBAArBW,UAAAC,MAAAZ,mBAAAW,UAAAE,QACMT,KAAcH,SAAAA,EAAQa,GAARb,MAAQc,KAA5BC,EAAAC,OAAAH,EAAAA,OAEIJ,KAAA,OAAAQ,MAAA,EAAAC,KAAAnB,mBAAAW,UAAAO,KAAAlB,mBAAAW,UAAAS,QAAApB,mBAAAW,UAAAU,OAaYC,KAbZjB,SAaiBkB,EAASP,EAAQF,EAAIU,GAbtC,GAAAC,GAAAT,EAAAS,OAAAC,EAAAD,EAAAC,iBAAAvB,KAAAwB,KAAAX,EAAAY,IAAAC,KAAA,kBAAA1B,MAAA2B,WACQJ,KAEAA,EAAAvB,KAAAwB,KAAAX,EAAAY,IAAAC,KAAAH,IAEIK,GAFJ7B,SAAA8B,QAGUhC,WAAAA,GACAwB,GAAAS,SAAAC,OAAA,WAhBlB7B,IAsBYiB,iBAAAA,YACItB,mBAAAmC,YACAvC,WAAA,yBACAS,iBACIqB,QAAAA,gBAAAA,eACH,IAAAU,cAAAA,WAAA,QAAAA,KAAA9B,gBAAAC,KAAA6B,GAAA,MAAA5B,cAAA4B,IAAAtD,IAAA,QAAA2B,MAAA,SACDO,EAAAqB,GACIC,GAAAA,GAAAA,EAAAA,OADeC,EAAAvB,EAEhBQ,SACNC,GAAAe,YAbLf,EAAAe,cA6BAC,QAfIP,QAAQlB,EAAA0B,WAGnBC,MAAA,EA1BDC,KAAAC,QAAAjB,IAAAkB,MAAA,IA2CQC,MAAUR,EAAV,QA3CZ,IAAAS,GAAAhC,EAAAiC,YAAA,cAiCI,OALJ5C,GAAAA,KAAkB1B,EAAAA,SAAAA,GAIV0B,YAARoB,EAA0BpB,YAA1B,SAAA6C,EAAAC,GACIf,GAAAZ,EAAA0B,OAAAF,MAfiBZ,IAiBbA,cAAAzD,YACAqB,mBAAWgB,MACXS,MAAAA,QACIgB,KAAAA,mBAAQ9B,UAAAO,KAAAlB,mBAAAW,UAAAyC,IAAApD,mBAAAW,UAAAE,UAAAjB,WAAA,yBAGR+C,cACAC,QAAAA,aAAMC","file":"../../tasks/webDefaultTask.js","sourcesContent":["\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n// import * as path from 'path';\nconst development_core_1 = require('development-core');\n// import * as chalk from 'chalk';\nconst karma_1 = require('karma');\nconst path = require('path');\nconst browserSync = require('browser-sync');\nconst del = require('del');\nlet WebDefaultTasks = class WebDefaultTasks {\n    tasks() {\n        return [\n            {\n                name: 'clean',\n                order: 0,\n                oper: development_core_1.Operation.clean | development_core_1.Operation.default,\n                task: (config, dt) => del(config.getSrc(dt, dt))\n            },\n            {\n                name: 'test',\n                test: true,\n                oper: development_core_1.Operation.test | development_core_1.Operation.release | development_core_1.Operation.deploy,\n                pipe(gulpsrc, config, dt, callback) {\n                    let option = config.option;\n                    let karmaConfigFile = option.karmaConfigFile || path.join(config.env.root, './karma.conf.js');\n                    if (!path.isAbsolute(karmaConfigFile)) {\n                        karmaConfigFile = path.join(config.env.root, karmaConfigFile);\n                    }\n                    new karma_1.Server({\n                        configFile: karmaConfigFile\n                    }, callback).start();\n                },\n                output: null\n            }\n        ];\n    }\n};\nWebDefaultTasks = __decorate([\n    development_core_1.dynamicTask, \n    __metadata('design:paramtypes', [])\n], WebDefaultTasks);\nexports.WebDefaultTasks = WebDefaultTasks;\nlet StartService = class StartService {\n    setup(config, gulp) {\n        let option = config.option;\n        let dist = config.getDist();\n        option.browsersync = option.browsersync || {\n            server: {\n                baseDir: config.getDist()\n            },\n            open: true,\n            port: process.env.PORT || 3000,\n            files: `${dist}/**/*`\n        };\n        let tkn = config.subTaskName('browsersync');\n        gulp.task(tkn, (callback) => {\n            browserSync(option.browsersync, (err, bs) => {\n                if (err) {\n                    callback(err);\n                }\n            });\n        });\n        return tkn;\n    }\n};\nStartService = __decorate([\n    development_core_1.task({\n        group: 'serve',\n        oper: development_core_1.Operation.test | development_core_1.Operation.e2e | development_core_1.Operation.default\n    }), \n    __metadata('design:paramtypes', [])\n], StartService);\nexports.StartService = StartService;\n"]}